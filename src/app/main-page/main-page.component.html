<div class="navbar navbar-default">
  <nav
    class="nav navbar navbar-expand-lg bg-light align-items-start d-lg-flex align-items-center"
  >
    <button
      class="navbar-toggler me-auto"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#navbarNavDropdown"
      aria-controls="navbarNavDropdown"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>

    <span class="nav navbar-brand h1">Movie filters!</span>

    <div class="collapse navbar-collapse" id="navbarNavDropdown">
      <ul class="nav navbar-nav">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" routerLink="/mainPage"
            >Home</a
          >
        </li>
        <li class="nav nav-item">
          <a class="nav-link" routerLink="/about">About</a>
        </li>

        <!-- "Popularity Filters" -->

        <li class="nav nav-item dropdown">
          <a
            class="btn btn-secondary dropdown-toggle"
            id="navbarDropdownMenuLink"
            role="button"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            Popularity
          </a>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
            <app-filter-component
              #popularityFilterComponent
              [FilterItems]="PopularityFilterItems"
              (filtersChanged)="onPopularityFiltersChanged($event)"
              [DataColumnName]="'Popularity'"
            ></app-filter-component>
          </ul>
        </li>

        <!-- "Genres Filters" -->

        <li class="nav nav-item dropdown">
          <a
            class="btn btn-secondary dropdown-toggle"
            href="#"
            id="navbarDropdownMenuLink"
            role="button"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            Genre
          </a>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
            <app-filter-component
              #genreFilterComponent
              [FilterItems]="GenreFilterItems"
              (filtersChanged)="onGenresFiltersChanged($event)"
              [DataColumnName]="'Genre'"
            ></app-filter-component>
          </ul>
        </li>

        <!-- "Cast Filters" -->

        <li class="nav nav-item dropdown">
          <a
            class="btn btn-secondary dropdown-toggle"
            href="#"
            id="navbarDropdownMenuLink"
            role="button"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            Cast Members
          </a>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
            <app-filter-component
              #castFilterComponent
              ng-attr-id="castTable"
              [FilterItems]="CastFilterItems"
              (filtersChanged)="onCastFiltersChanged($event)"
              [DataColumnName]="'Cast Member'"
            ></app-filter-component>
          </ul>
        </li>

        <!-- "Release Year Filters" -->

        <li class="nav nav-item dropdown">
          <a
            class="btn btn-secondary dropdown-toggle"
            href="#"
            id="navbarDropdownMenuLink"
            role="button"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            Release Year
          </a>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
            <app-filter-component
              #releaseYearFilterComponent
              [FilterItems]="ReleaseYearFilterItems"
              (filtersChanged)="onReleaseYearsFiltersChanged($event)"
              [DataColumnName]="'Release Year'"
            ></app-filter-component>
          </ul>
        </li>

        <!-- "Director Filters" -->

        <li class="nav nav-item dropdown">
          <a
            class="btn btn-secondary dropdown-toggle"
            href="#"
            id="navbarDropdownMenuLink"
            role="button"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            Director
          </a>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
            <app-filter-component
              #directorFilterComponent
              [FilterItems]="DirectorFilterItems"
              (filtersChanged)="onDirectorFiltersChanged($event)"
              [DataColumnName]="'Director'"
            ></app-filter-component>
          </ul>
        </li>

        <!-- Drop down selector for num of results -->

        <li class="nav nav-item me-auto">
          <select
            #filterNumber
            name="filterNumber"
            id="filterNumber"
            (change)="reslice()"
            class="form-select"
          >
            <option value="5" selected>5</option>
            <option value="10">10</option>
            <option value="15">15</option>
            <option value="20">20</option>
            <option value="25">25</option>
            <option value="30">30</option>
          </select>
        </li>

        <li class="nav nav-item me-auto">
          <button class="btn btn-primary" (click)="clearFilters()">
            Clear Filters
          </button>
        </li>
        <!-- Apply filters button 
            <li class="nav nav-item me-auto">
              <button class="btn btn-primary" (click)="doFiltering()">Apply Filters</button>
            </li>
            -->
      </ul>
    </div>
  </nav>
</div>

<!-- Display applied filters -->

<div class="container m-1">
  <app-display-filter #requestedFilters></app-display-filter>
</div>

<!-- Table to display filtered results -->

<div class="container-fluid my-5">
  <table
    #resultsTable
    mat-table
    [dataSource]="sortedMovies"
    class="table table-striped"
  >
    <ng-container matColumnDef="title">
      <th mat-header-cell *matHeaderCellDef>Title</th>
      <td mat-cell *matCellDef="let movie">
        <!-- matTooltip is what display the short summar on hover -->
        <a
          href="https://www.imdb.com/title/{{ movie.id }}/"
          target="_blank"
          matTooltip="{{ movie.short_summary }}"
          >{{ movie.title }}</a
        >
      </td>
    </ng-container>
    <ng-container matColumnDef="popularity">
      <th mat-header-cell *matHeaderCellDef>Popularity</th>
      <td mat-cell *matCellDef="let movie">{{ movie.popularity }}</td>
    </ng-container>
    <ng-container matColumnDef="budget">
      <th mat-header-cell *matHeaderCellDef>Budget</th>
      <td mat-cell *matCellDef="let movie">
        ${{ movie.budget | largeNumSuffix }}
      </td>
    </ng-container>
    <ng-container matColumnDef="revenue">
      <th mat-header-cell *matHeaderCellDef>Revenue</th>
      <td mat-cell *matCellDef="let movie">
        ${{ movie.revenue | largeNumSuffix }}
      </td>
    </ng-container>
    <ng-container matColumnDef="cast">
      <th mat-header-cell *matHeaderCellDef>Cast</th>
      <td mat-cell *matCellDef="let movie">{{ movie.cast | addSpace }}</td>
    </ng-container>
    <ng-container matColumnDef="director">
      <th mat-header-cell *matHeaderCellDef>Director</th>
      <td mat-cell *matCellDef="let movie">{{ movie.director }}</td>
    </ng-container>
    <ng-container matColumnDef="genres">
      <th mat-header-cell *matHeaderCellDef>Genres</th>
      <td mat-cell *matCellDef="let movie">{{ movie.genres | addSpace }}</td>
    </ng-container>
    <ng-container matColumnDef="release_year">
      <th mat-header-cell *matHeaderCellDef>Release Year</th>
      <td mat-cell *matCellDef="let movie">{{ movie.release_year }}</td>
    </ng-container>
    <ng-container matColumnDef="relevance">
      <th mat-header-cell *matHeaderCellDef>Relevance</th>
      <td mat-cell *matCellDef="let movie">{{ movie.relevance }}</td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="displayColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayColumns"></tr>
  </table>
</div>
